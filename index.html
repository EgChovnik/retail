<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Магазин товаров</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--tg-theme-bg-color, #ffffff);
            color: var(--tg-theme-text-color, #000000);
            padding: 16px;
            min-height: 100vh;
        }

        .header {
            text-align: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--tg-theme-hint-color, #e0e0e0);
        }

        .header h1 {
            font-size: 24px;
            font-weight: 600;
            color: var(--tg-theme-text-color, #000000);
            margin-bottom: 8px;
        }

        .header p {
            font-size: 14px;
            color: var(--tg-theme-hint-color, #999999);
        }

        .products-grid {
            display: grid;
            gap: 12px;
            margin-bottom: 24px;
        }

        .product-item {
            background-color: var(--tg-theme-secondary-bg-color, #f8f8f8);
            border: 2px solid transparent;
            border-radius: 12px;
            padding: 16px;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }

        .product-item:hover {
            background-color: var(--tg-theme-section-bg-color, #f0f0f0);
        }

        .product-item.selected {
            border-color: var(--tg-theme-button-color, #0088cc);
            background-color: var(--tg-theme-section-bg-color, #e3f2fd);
        }

        .product-item.selected::after {
            content: '✓';
            position: absolute;
            top: 12px;
            right: 12px;
            background-color: var(--tg-theme-button-color, #0088cc);
            color: var(--tg-theme-button-text-color, #ffffff);
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
        }

        .product-emoji {
            font-size: 32px;
            margin-bottom: 8px;
            display: block;
        }

        .product-name {
            font-size: 16px;
            font-weight: 600;
            color: var(--tg-theme-text-color, #000000);
            margin-bottom: 4px;
        }

        .product-description {
            font-size: 13px;
            color: var(--tg-theme-hint-color, #999999);
            margin-bottom: 8px;
            line-height: 1.3;
        }

        .product-price {
            font-size: 16px;
            font-weight: 700;
            color: var(--tg-theme-button-color, #0088cc);
        }

        .bottom-spacer {
            height: 100px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Наш магазин</h1>
        <p>Выберите товары для заказа</p>
    </div>

    <div class="products-grid" id="productsGrid">
        <!-- Товары будут добавлены через JavaScript -->
    </div>

    <div class="bottom-spacer"></div>

    <div class="friendly-thug">
        <iframe width="560" height="315" src="https://www.youtube.com/embed/toyY9NScPMc?si=poWTJvFDpCisZPzs" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
    </div>

    <script>
        // Инициализация Telegram WebApp
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.ready();

        // Данные товаров
        const products = [
            { id: 1, name: 'Смартфон iPhone', description: 'Последняя модель с отличной камерой', price: 89990 },
            { id: 2, name: 'Ноутбук MacBook', description: 'Мощный ноутбук для работы и творчества', price: 129990 },
            { id: 3, name: 'Наушники AirPods', description: 'Беспроводные наушники с шумоподавлением', price: 24990 },
            { id: 4, name: 'Умные часы', description: 'Следите за здоровьем и уведомлениями', price: 34990 },
            { id: 5, name: 'Планшет iPad', description: 'Идеален для работы и развлечений', price: 54990 },
            { id: 6, name: 'Игровая консоль', description: 'Новейшая консоль для игр', price: 49990 },
            { id: 7, name: 'Фотоаппарат', description: 'Профессиональная камера для фото', price: 79990 },
            { id: 8, name: 'Умная колонка', description: 'Голосовой помощник с отличным звуком', price: 12990 },
            { id: 9, name: 'Электросамокат', description: 'Экологичный транспорт для города', price: 39990 },
            { id: 10, name: 'Кофемашина', description: 'Автоматическая кофемашина для дома', price: 29990 }
        ];

        let selectedProducts = [];

        // Создание элементов товаров
        function createProductElements() {
            const grid = document.getElementById('productsGrid');
            
            products.forEach(product => {
                const productElement = document.createElement('div');
                productElement.className = 'product-item';
                productElement.dataset.productId = product.id;
                
                productElement.innerHTML = `
                    <div class="product-name">${product.name}</div>
                    <div class="product-description">${product.description}</div>
                    <div class="product-price">${product.price.toLocaleString('ru-RU')} ₽</div>
                `;
                
                productElement.addEventListener('click', () => toggleProduct(product));
                grid.appendChild(productElement);
            });
        }

        // Переключение выбора товара
        function toggleProduct(product) {
            const productElement = document.querySelector(`[data-product-id="${product.id}"]`);
            const isSelected = selectedProducts.some(p => p.id === product.id);
            
            if (isSelected) {
                selectedProducts = selectedProducts.filter(p => p.id !== product.id);
                productElement.classList.remove('selected');
            } else {
                selectedProducts.push(product);
                productElement.classList.add('selected');
            }
            
            updateMainButton();
            
            // Вибрация при выборе (если поддерживается)
            if (tg.HapticFeedback) {
                tg.HapticFeedback.impactOccurred('light');
            }
        }

        // Обновление главной кнопки при изменении выбора
        function updateMainButton() {
            if (selectedProducts.length > 0) {
                tg.MainButton.setText(`Отправить заказ (${selectedProducts.length})`);
                tg.MainButton.show();
            } else {
                tg.MainButton.hide();
            }
        }

        // Отправка данных боту
        function sendDataToBot() {
            if (selectedProducts.length === 0) return;
            
            const dataToSend = selectedProducts.map(product => ({
                id: product.id,
                name: product.name,
                price: product.price
            }));
            
            tg.sendData(JSON.stringify(dataToSend));
        }

        // Инициализация
        document.addEventListener('DOMContentLoaded', () => {
            createProductElements();
            
            // Настройка главной кнопки Telegram
            tg.MainButton.setText('Отправить заказ');
            tg.MainButton.onClick(sendDataToBot);
        });
    </script>
</body>
</html>
